# 快速测试指南

## 统一测试文件

所有测试功能已整合到 **`core/test.py`** 一个文件中。

## 方法一：在 core 目录内运行（推荐）

1. **进入 core 目录**
   ```bash
   cd core
   ```

2. **安装依赖**
   ```bash
   pip install -r requirements.txt
   ```

3. **修改配置**
   
   打开 `test.py`，修改以下参数：
   ```python
   BASE_URL = "你的 ShowDoc URL"  # 例如: "https://doc.cqfengli.com/web/#/90"
   COOKIE = None                   # 可选，如果提供则使用 Cookie 认证
   PASSWORD = "123456"             # 默认密码，如果未提供 COOKIE 则使用密码自动登录
   NODE_NAME = None                # None=全部, 或指定节点名称如 "订单"
   EXPORT_PATH = None              # None=交互询问, 或指定路径如 "output/data.json"
   ```

4. **运行测试**
   ```bash
   python test.py
   ```

## 方法二：从项目根目录运行

1. **打开项目根目录**
   ```bash
   cd C:\Users\Administrator\Desktop\fengli
   ```

2. **安装依赖**
   ```bash
 ~  pip install -r core/requirements.txt~
   ```

3. **修改配置**
   
   打开 `core/test.py`，修改配置参数。

4. **运行测试**
   ```bash
   python -m core.test
   ```

## 方法三：在 Python 交互式环境中测试

```python
# 1. 进入项目根目录
import sys
from pathlib import Path
sys.path.insert(0, str(Path.cwd()))

# 2. 导入模块
from core import ShowDocClient

# 3. 创建客户端（方式1：使用 Cookie）
base_url = "https://doc.cqfengli.com/web/#/90/"
cookie = "think_language=zh-CN; PHPSESSID=xxx"
client = ShowDocClient(base_url, cookie=cookie)

# 或方式2：使用密码自动登录（默认密码 123456）
client = ShowDocClient(base_url, password="123456")

# 4. 获取数据
api_tree = client.get_all_apis()

# 5. 查看结果
print(f"项目: {api_tree.item_info.item_name}")
print(f"分类数: {len(api_tree.categories)}")
for cat in api_tree.categories[:3]:
    print(f"  - {cat.cat_name}: {len(cat.pages)} 个页面")
```

## 认证方式

### 方式1：使用密码自动登录（推荐，默认密码 123456）

无需手动获取 Cookie，直接使用密码即可：

```python
client = ShowDocClient(base_url, password="123456")
```

系统会自动进行验证码识别和登录。

### 方式2：使用 Cookie（传统方式）

如果需要使用 Cookie：

1. 在浏览器中登录 ShowDoc
2. 打开开发者工具（按 F12）
3. 切换到 "Network"（网络）标签
4. 刷新页面或访问任意页面
5. 点击任意请求
6. 在 "Request Headers"（请求头）中找到 "Cookie"
7. 复制 Cookie 的值

```python
client = ShowDocClient(base_url, cookie="think_language=zh-CN; PHPSESSID=xxx")
```

## 预期输出

运行成功后，你会看到类似这样的输出：

```
======================================================================
ShowDoc 客户端测试
======================================================================

[步骤 1] 初始化客户端...
✓ 成功
  - 服务器地址: https://doc.cqfengli.com
  - 项目 ID: 90

[步骤 2] 获取接口数据 (节点: 全部)...
✓ 成功获取数据

[步骤 3] 项目信息:
  - 项目 ID: 90
  - 项目名称: 你的项目名称
  - 分类数量: X

[步骤 4] 分类结构:
分类 1:
  📁 分类名称 (ID: xxx)
    📄 页面标题
       └─ GET /api/example
  ...

[步骤 5] 统计信息:
  - 总分类数: X
  - 总页面数: X
  - API 页面数: X

[步骤 6] 导出数据
  是否导出为 JSON 文件？(y/n, 默认n):
```

## 常见问题

### 问题1: ModuleNotFoundError: No module named 'core'

**解决方法：**
- 确保在项目根目录运行脚本
- 或使用 `python -m core.test_simple` 的方式运行

### 问题2: 认证失败

**解决方法：**
- 检查 Cookie 是否有效
- 重新登录 ShowDoc 获取新 Cookie
- 确保 Cookie 格式正确（使用分号和空格分隔）

### 问题3: 找不到节点

**解决方法：**
- 先使用 `NODE_NAME = None` 获取全部节点
- 查看输出的分类列表，找到正确的节点名称
- 注意节点名称区分大小写

